{"ast":null,"code":"import _regeneratorRuntime from\"/home/oscaridberg/dbwebb-kurser/jsramverk/react-text-editor/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/oscaridberg/dbwebb-kurser/jsramverk/react-text-editor/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/oscaridberg/dbwebb-kurser/jsramverk/react-text-editor/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import'./style/App.css';import'./style/TextEditor.css';import React,{useEffect}from'react';import TextEditor from'./components/TextEditor.js';import Login from'./components/Login.js';import{useState}from'react';import{io}from\"socket.io-client\";import config from'./config/config.json';import authModel from'./models/auth';import docsModel from'./models/docs';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var socket;var SERVER_URL=config.base_url;// \"base_url\": \"https://jsramverk-editor-osid15.azurewebsites.net/\"\nfunction App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),docs=_useState2[0],setDocs=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),currentDoc=_useState4[0],setCurrentDoc=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),token=_useState6[0],setToken=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),user=_useState8[0],setUser=_useState8[1];function getAllDocs(){return _getAllDocs.apply(this,arguments);}function _getAllDocs(){_getAllDocs=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var allDocs;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return docsModel.getAllDocs(user);case 2:allDocs=_context2.sent;_context2.t0=setDocs;_context2.next=6;return allDocs;case 6:_context2.t1=_context2.sent;(0,_context2.t0)(_context2.t1);case 8:case\"end\":return _context2.stop();}}},_callee2);}));return _getAllDocs.apply(this,arguments);};function fetchDoc(_x){return _fetchDoc.apply(this,arguments);}function _fetchDoc(){_fetchDoc=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(event){var title,doc;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:title=event.target.value;_context3.next=3;return docsModel.getOneDoc(title,token);case 3:doc=_context3.sent;setCurrentDoc(doc);case 5:case\"end\":return _context3.stop();}}},_callee3);}));return _fetchDoc.apply(this,arguments);};function saveDoc(_x2,_x3){return _saveDoc.apply(this,arguments);}function _saveDoc(){_saveDoc=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(title,content){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return docsModel.saveDoc(title,content,token,user);case 2:case\"end\":return _context4.stop();}}},_callee4);}));return _saveDoc.apply(this,arguments);}useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getAllDocs();case 2:case\"end\":return _context.stop();}}},_callee);}))();},[token]);useEffect(function(){socket=io(SERVER_URL);socket.emit(\"create\",currentDoc[\"_id\"]);var data={_id:currentDoc['_id'],title:currentDoc['title'],html:currentDoc['content'],authUser:user.email};socket.emit(\"doc\",data);socket.on(\"doc\",function(data){if(currentDoc['content']!==data.html){setCurrentDoc({_id:currentDoc._id,title:currentDoc.title,content:data.html,authUser:user.email});}});return function(){socket.disconnect();};},[currentDoc]);return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"appTitle\",children:\"React Text Editor\"}),token?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(TextEditor,{currentDoc:currentDoc,setCurrentDoc:setCurrentDoc,docs:docs,fetchDoc:fetchDoc,saveDoc:saveDoc})}):/*#__PURE__*/_jsx(Login,{setToken:setToken,user:user,setUser:setUser})]});}export default App;","map":{"version":3,"names":["React","useEffect","TextEditor","Login","useState","io","config","authModel","docsModel","socket","SERVER_URL","base_url","App","docs","setDocs","currentDoc","setCurrentDoc","token","setToken","user","setUser","getAllDocs","allDocs","fetchDoc","event","title","target","value","getOneDoc","doc","saveDoc","content","emit","data","_id","html","authUser","email","on","disconnect"],"sources":["/home/oscaridberg/dbwebb-kurser/jsramverk/react-text-editor/src/App.js"],"sourcesContent":["import './style/App.css';\nimport './style/TextEditor.css'\nimport React, { useEffect } from 'react';\nimport TextEditor from './components/TextEditor.js';\nimport Login from './components/Login.js';\nimport { useState } from 'react';\nimport { io } from \"socket.io-client\";\nimport config from './config/config.json';\nimport authModel from './models/auth';\nimport docsModel from './models/docs';\n\n\nlet socket;\nconst SERVER_URL = config.base_url;\n// \"base_url\": \"https://jsramverk-editor-osid15.azurewebsites.net/\"\n\n\n\nfunction App() {\n  const [docs, setDocs] = useState([]);\n  const [currentDoc, setCurrentDoc] = useState([]);\n  const [token, setToken] = useState('');\n  const [user, setUser] = useState({});\n\n\n  async function getAllDocs() {\n    const allDocs = await docsModel.getAllDocs(user);\n    setDocs(await allDocs);\n  };\n\n  async function fetchDoc(event) {\n    const title = event.target.value;\n    const doc = await docsModel.getOneDoc(title, token);\n    setCurrentDoc(doc);\n  };\n\n  async function saveDoc(title, content) {\n    await docsModel.saveDoc(title, content, token, user);\n  }\n\n  useEffect(() => {\n    (async () => {\n      await getAllDocs();\n    })();\n  }, [token]);\n\n  useEffect(() => {\n    socket = io(SERVER_URL);\n    socket.emit(\"create\", currentDoc[\"_id\"]);\n    let data = {\n      _id: currentDoc['_id'],\n      title: currentDoc['title'],\n      html: currentDoc['content'],\n      authUser: user.email\n    };\n    \n    socket.emit(\"doc\", data);\n\n    socket.on(\"doc\", (data) => {\n      if (currentDoc['content'] !== data.html) {\n        setCurrentDoc({\n          _id: currentDoc._id,\n          title: currentDoc.title, \n          content: data.html,\n          authUser: user.email\n        })\n      }\n  });\n\n    return () => {\n      socket.disconnect();\n    }\n  }, [currentDoc]);\n\n  return (\n    <div className=\"App\">\n      <h1 className='appTitle'>React Text Editor</h1>\n      {token ? \n      <>\n       <TextEditor currentDoc={currentDoc} setCurrentDoc={setCurrentDoc} docs={docs} fetchDoc={fetchDoc} saveDoc={saveDoc}/>\n      </>\n      :\n      <Login setToken={setToken} user={user} setUser={setUser} />}\n    </div>\n  );\n}\n\nexport default App;"],"mappings":"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"},"metadata":{},"sourceType":"module"}